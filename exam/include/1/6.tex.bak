\subsection{Матричное представление метода контурных токов и узловых потенциалов}

\subsubsection{Топологические понятия и топологические матрицы}

Положим, что в схеме имеется y узлов и b ветвей. Каждая пара узлов соединена одной ветвью. Перед составленем матриц схемы графа нумеруют и на них ставят стрелки, указывающие положительные нарпавления для отсчёта тока и напряжения на каждой ветви. Перед нумерацией графа выбирается дерево.
 
{\bfseries Дерево} представляет собой такую совокупность узлов схемы, когда ветви касаются всех узлов, но не образуют ни одного замкнутого контура. Число ветвей дерева, таким образом, равно y-1. Нумерацию ветвей графа начинают с нумерации ветвей дерева(с 1 по y-1). Номера с y по b придают ветвям графа, не вошедшим в выбранное дерево. Их называют {\bfseries ветвями связи} или {\bfseries хордами}
 
\begin{itemize}
\item Узловая матрица $[A]$ составляется для n-1 узла графа цепи, в ней столбцы обозначают ветви, а строки - узлы. Элементы: 1,-1,0. Делается следующее:
\begin{itemize}
\item Каждый узел охватывается некоторой поверхностью, след которой можно показать кружком
\item В соответствующую ячейку матрицы ставят знак 1, если стрелка ветви направлена из кружка, -1, если внутрь и 0, если ветвь не затронута кружком.
\end{itemize}
\end{itemize}

\begin{itemize}
\item Матрицу сечений $[Q]$ составляют для любых сечений графа, а матрицу главных сечений $[Q_{main}]$ - для главных сечений выбранного дерева. След сечения на рисунке показывают овалами, вычерченными тонкими линиями.

{\slshape Главными сечениями } называют сечения, каждое из которых рассекает несколько ветвей связи и только 1 ветвь выбранного дерева. Главные сечения нумеруют. Делается следующее:

\begin{itemize}
\item В ячейках соответствующей строки матрицы $Q_{main}$ ставят 1 для рассекаемой этим сечением ветви дерева.
\item Если линии связи ориентированы относительно поверхности сечения так же, как и данная ветвь дерева, то ставится знак 1. В противоположном случае $-$ -1, в другом случае 0.
\end{itemize}
\end{itemize}

\begin{itemize}
\item {\slshape Главными контурами} называют контуры, в каждый из которых входит только по 1 ветви связи. Нумеруют главные контуры теми же номерами, какие присвоены ветвям связи в них.

{\slshape Матрицей главных контуров} $[K_{main}]$ называют матрицу, составленную из чисел 0,1,-1, строки которой соответствуют номеру главного контура, а столбцы - номеру ветви. Делается следующее:
\begin{itemize}
\item Главные контуры при составлении матрицы обходят в направлении {\bfseries ветви связи} соответствующего контура. 

\item Если при таком обходе направление стрелки совпадает с направлением обхода - пишется 1.
\end{itemize} 
 
\end{itemize}
\subsubsection{Запись уравнений по законам Кирхгофа}
\begin{itemize}

\end{itemize}
\item Совокупоность уравнений по первому закону Кирхгофа: $[A][I_v] = 0$, где $[I_v]$ - транспонированная матрица-строка токов ветвей.
\item Совокупоность уравнений по второму закону Кирхгофа: $[K_{main}][U_v] = 0$, где $[U_v]$ - матрица-столбец напряжения ветвей.

\begin{center}
	\begin{figure}[h!]
		\center{\includegraphics[scale=1]{chord.png}}
		\caption{обобщенная ветвь}	
	\end{figure}
\end{center}
Вводится понятие обобщенной ветви, изображенной на рисунке.
Уравнение:

\begin{equation}
U+E=R(I+J)
\end{equation}
или
\begin{equation}
I+J=g(U+E)
\end{equation}

\subsubsection{Для МКТ}

Записываем матричное уравнение обобщенных ветвей.

\begin{equation}
[K][U]+[K][E]=[K][R] ([I]+[J])
\end{equation}

Из 2-го закона Кирхгофа $[K][U]=0$

И токи в ветвях могут быть записаны как $[I]=[K]^T[I_{kk}]$ 

Т.о. 

\begin{equation}
[K][E] = [K][R][K]^T[I_{kk}]+[K][R][J]
\end{equation}

\begin{equation}
[I_{kk}] = ([K][R][K]^T )^{-1} ([K][E] - [K][R][J])
\end{equation}


\subsubsection{Для МУП}

Записываем матричное уравнение обобщенных ветвей.


\begin{equation}
[A][I]+[A][J]=[A][g] ([U]+[E])
\end{equation}

Из 1-го закона Кирхгофа $[A][I]=0$



И токи в ветвях могут быть записаны как $[U]=[A]^T[\phi_{k}]$ 
%Возможно, требует пояснения, однако становится более-менее понятно при записи непосредственно матриц и произведения умножения
Т.о. 

\begin{equation}
[A][J] = [A][g][A]^T[\phi_{k}]+[A][g][E]
\end{equation}

\begin{equation}
[\phi_{k}] = ([A][g][A]^T )^{-1} ([A][J] - [A][g][E])
\end{equation}


\pagebreak